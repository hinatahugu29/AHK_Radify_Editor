# トラブルシューティング

このページでは、Radify Menu Editorの使用中に発生する可能性のある問題と解決方法を説明します。

## エディタ起動時の問題

### Pythonが認識されない

**症状**: `python: command not found` または類似のエラー

**解決方法**:

1. Pythonがインストールされているか確認
   ```bash
   python --version
   ```

2. `python3`コマンドを試す
   ```bash
   python3 main.py
   ```

3. Pythonを環境変数PATHに追加
   - 「システムのプロパティ」→「環境変数」
   - PATH に Python のインストールフォルダを追加

### モジュールが見つからない

**症状**: `ModuleNotFoundError: No module named 'customtkinter'`

**解決方法**:

依存パッケージを再インストール:

```bash
pip install -r requirements.txt
```

または個別にインストール:

```bash
pip install customtkinter Pillow
```

### エディタウィンドウが表示されない

**症状**: スクリプトは起動するがウィンドウが表示されない

**解決方法**:

1. エラーメッセージを確認（コンソールに表示）
2. ディスプレイ設定を確認（スケーリングが100%以外の場合に問題が発生することも）
3. CustomTkinterを最新版に更新
   ```bash
   pip install --upgrade customtkinter
   ```

## ファイル読み込みの問題

### 設定ファイルが読み込めない

**症状**: 「設定ファイルの読み込みに失敗しました」

**解決方法**:

1. JSON構文エラーをチェック
   - [JSONLint](https://jsonlint.com/) で検証
   - カンマの位置、引用符の閉じ忘れを確認

2. ファイルパーミッションを確認
   - ファイルが読み取り専用になっていないか

3. バックアップから復元
   ```bash
   copy backups\autosave_*.json menu_config.json
   ```

### 画像が読み込めない

**症状**: アイコン画像が表示されない、またはエラー

**解決方法**:

1. 画像ファイルが存在するか確認
2. 画像形式が対応しているか確認（PNG, JPG, BMP, ICO）
3. ファイルパスに日本語や特殊文字が含まれていないか確認
4. 画像が破損していないか別のアプリで開いて確認

## UI操作の問題

### ツリービューが更新されない

**症状**: アイテムを追加・削除してもツリービューに反映されない

**解決方法**:

1. F5キーでプレビューを更新
2. エディタを再起動
3. 設定を保存してから再度開く

### プレビューが正しく表示されない

**症状**: プレビューキャンバスが真っ白、または正しく描画されない

**解決方法**:

1. ズームレベルをリセット（Ctrl+0）
2. プレビューパネルのサイズを変更
3. エディタを再起動
4. グラフィックドライバを更新

### ドラッグ&ドロップが動作しない

**症状**: ツリービューでアイテムを移動できない

**解決方法**:

1. アイテムを選択してから「上へ」「下へ」ボタンを使用
2. エディタを再起動
3. 該当アイテムをコピー&ペーストで移動

## 設定保存の問題

### 保存ができない

**症状**: 「保存に失敗しました」エラー

**解決方法**:

1. ファイルが他のプログラムで開かれていないか確認
2. ディスク空き容量を確認
3. 管理者権限でエディタを起動
4. 別名で保存を試す

### 自動保存が動作しない

**症状**: バックアップフォルダにファイルが作成されない

**解決方法**:

1. `backups/` フォルダが存在するか確認
2. フォルダの書き込み権限を確認
3. 手動で保存（Ctrl+S）を試す

## スクリプト出力の問題

### AHKスクリプトが出力されない

**症状**: エクスポートボタンを押してもファイルが作成されない

**解決方法**:

1. 出力先フォルダの書き込み権限を確認
2. 出力先に十分な空き容量があるか確認
3. パスに日本語や特殊文字が含まれていないか確認

### 出力されたスクリプトが動作しない

**症状**: 生成された.ahkファイルをダブルクリックしてもメニューが表示されない

**解決方法**:

1. AutoHotkey v2がインストールされているか確認
   ```bash
   autohotkey --version
   ```

2. スクリプトを右クリック→「Edit Script」でエラーを確認

3. 必要なライブラリファイルが揃っているか確認
   - `Radify.ahk`
   - `Lib/Gdip_All.ahk`

4. 画像リソースが正しくコピーされているか確認

## パフォーマンスの問題

### エディタが遅い

**症状**: 操作に遅延がある、反応が鈍い

**解決方法**:

1. メモリ使用量を確認（タスクマネージャー）
2. 不要なアイテムを削除してメニューを簡素化
3. 画像リストから未使用の画像を削除
4. PCを再起動

### プレビューの描画が遅い

**症状**: プレビューの更新に時間がかかる

**解決方法**:

1. 画像ファイルのサイズを小さくする
2. アイテム数を減らす
3. ズームレベルを下げる

## AutoHotkeyスクリプトの問題

### メニューが表示されない

**症状**: ホットキーを押してもメニューが表示されない

**解決方法**:

1. スクリプトが実行中か確認（タスクバーのAHKアイコン）
2. ホットキーが他のアプリと競合していないか確認
3. スクリプトを管理者として実行
4. ホットキーを変更して試す

### アイコンが表示されない

**症状**: メニューは表示されるがアイコンが表示されない

**解決方法**:

1. `images/` フォルダがスクリプトと同じ場所にあるか確認
2. 画像ファイル名が正しいか確認
3. 画像パスを絶対パスに変更して試す

### アクションが実行されない

**症状**: アイテムをクリックしても何も起こらない

**解決方法**:

1. アクションコードに構文エラーがないか確認
2. MsgBoxを追加してデバッグ
   ```ahk
   MsgBox "アクションが実行されました"
   Run "notepad.exe"
   ```
3. パスやコマンドが正しいか確認

## 画面キャプチャの問題

### キャプチャができない

**症状**: 画面キャプチャボタンを押しても何も起こらない

**解決方法**:

1. エディタを管理者として実行
2. セキュリティソフトが干渉していないか確認
3. 別のスクリーンキャプチャツールを使用して画像を作成

### キャプチャした画像がぼやける

**症状**: キャプチャした画像の品質が低い

**解決方法**:

1. より大きな範囲をキャプチャ
2. ディスプレイのスケーリング設定を確認
3. 外部ツールで高品質な画像を作成

## よくあるエラーメッセージ

### "JSON decode error"

**原因**: 設定ファイルのJSON構文エラー

**解決方法**:

1. バックアップから復元
2. [JSONLint](https://jsonlint.com/)で検証
3. 手動で修正（カンマ、引用符を確認）

### "Permission denied"

**原因**: ファイルの書き込み権限がない

**解決方法**:

1. 管理者として実行
2. ファイルの読み取り専用属性を解除
3. 別の場所に保存

### "File not found"

**原因**: 指定されたファイルが存在しない

**解決方法**:

1. ファイルパスを確認
2. 相対パスと絶対パスを見直す
3. ファイルが実際に存在するか確認

## デバッグのヒント

### ログファイルの確認

エラー情報をファイルに出力:

```python
# core.py に追記
import logging
logging.basicConfig(filename='debug.log', level=logging.DEBUG)
logging.debug('Debug information')
```

### ステップバイステップで確認

1. シンプルなメニューから始める
2. 少しずつアイテムを追加
3. 問題が発生した時点で原因を特定

### 設定ファイルの最小化

問題を切り分けるため、最小限の設定で試す:

```json
{
  "image_dir": "images",
  "main_menu": [
    {
      "ring": 1,
      "items": [
        {
          "label": "テスト",
          "action": "MsgBox \"Test\""
        }
      ]
    }
  ],
  "submenus": {},
  "menu_options": {
    "skin": "Default",
    "menu_name": "testMenu"
  },
  "favorites": []
}
```

## サポート情報

### ヘルプリソース

- [GitHubリポジトリ](https://github.com/hinatahugu29/AHK_Radify_Editor)
- [Issues](https://github.com/hinatahugu29/AHK_Radify_Editor/issues)
- [Discussions](https://github.com/hinatahugu29/AHK_Radify_Editor/discussions)

### バグ報告

GitHubのIssuesで報告する際に含めるべき情報:

1. **環境情報**:
   - OS（Windows 10/11）
   - Pythonバージョン
   - AutoHotkeyバージョン

2. **問題の詳細**:
   - 何をしたか
   - 期待される動作
   - 実際の動作

3. **再現手順**:
   - ステップバイステップの手順

4. **エラーメッセージ**:
   - 完全なエラーメッセージ

5. **スクリーンショット**:
   - 可能であれば画像を添付

## 既知の問題

### CustomTkinterのテーマ問題

**症状**: ダークモードで一部のテキストが見えない

**ワークアラウンド**: appearance_modeを"Light"に変更

### 高DPI環境での表示

**症状**: 高解像度ディスプレイで表示が崩れる

**ワークアラウンド**: Windowsの互換性設定で「高DPIスケーリングの動作を上書きします」を設定

## 次のステップ

問題が解決しない場合:

1. [GitHubでIssueを開く](https://github.com/hinatahugu29/AHK_Radify_Editor/issues/new)
2. [Discussionsで質問](https://github.com/hinatahugu29/AHK_Radify_Editor/discussions)
3. ドキュメントを再確認
   - [インストール](../getting-started/installation.md)
   - [基本操作](../user-guide/basic-usage.md)
