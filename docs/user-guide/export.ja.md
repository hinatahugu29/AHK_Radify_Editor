# スクリプト出力

このページでは、作成したメニューをAutoHotkeyスクリプトとして出力する方法を説明します。

## エクスポート機能

### 基本的な出力手順

1. メニューバーから **「ファイル」→「AHKスクリプト出力」**
2. 出力先フォルダを選択
3. 「OK」をクリック

エクスポートが完了すると、以下のファイル・フォルダが作成されます:

```
MyRadifyMenu/
├── MyMenu.ahk           # メインスクリプト
├── Radify.ahk           # Radifyライブラリ
├── Lib/
│   └── Gdip_All.ahk     # GDI+ライブラリ
└── images/              # 使用したアイコン
    ├── icon1.png
    ├── icon2.png
    └── ...
```

## 出力されるファイル

### メインスクリプト (.ahk)

メニュー設定を含むAutoHotkey v2スクリプトです。

主な内容:

- Radifyライブラリのインクルード
- メニュー構造の定義
- 各アイテムのアクション定義
- ホットキー設定（起動キー）

### Radify.ahk

リングメニュー描画のコアライブラリです。このファイルは変更しないでください。

### Lib/Gdip_All.ahk

GDI+を使用した高度なグラフィック描画ライブラリです。

### images/

メニューで使用したすべてのアイコン画像が自動的にコピーされます。

## 出力スクリプトの実行

### 基本的な実行方法

1. 出力フォルダ内の `.ahk` ファイルをダブルクリック
2. タスクバーにAutoHotkeyのアイコンが表示される
3. 設定したホットキーでメニューを開く（デフォルト: `Ctrl+Space`）

### ホットキーのカスタマイズ

スクリプトを開いて、ホットキー部分を編集:

```ahk
; デフォルト
^Space::myMainMenu.Show()

; 変更例: Win+Zキー
#z::myMainMenu.Show()
```

!!! tip "ホットキー記法"
    - `^`: Ctrl
    - `!`: Alt
    - `+`: Shift
    - `#`: Win

## ポータブルパッケージの作成

### 完全なポータブル環境

出力フォルダには必要なファイルがすべて含まれているため、以下の用途に使用できます:

#### USBメモリで持ち運び

1. 出力フォルダをUSBメモリにコピー
2. 任意のWindows PCで実行（AutoHotkey v2が必要）

#### 他のPCで使用

1. 出力フォルダをZIP圧縮
2. メールやクラウドで共有
3. 解凍して実行

### 依存関係

実行には **AutoHotkey v2** のインストールが必要です。

スタンドアローン実行ファイル（.exe）にコンパイルすることで、AutoHotkeyのインストール無しで実行可能になります（後述）。

## スクリプトのカスタマイズ

### 起動時の自動実行

Windowsスタートアップに登録:

1. `Win+R` で「ファイル名を指定して実行」を開く
2. `shell:startup` と入力
3. スクリプトのショートカットを作成してスタートアップフォルダに配置

### 複数メニューの切り替え

異なるホットキーで複数のメニューを呼び出す:

```ahk
^Space::myMainMenu.Show()
^!Space::mySubMenu.Show()
```

### メニュー表示位置の変更

```ahk
; マウスカーソル位置に表示（デフォルト）
myMainMenu.Show()

; 座標指定
myMainMenu.Show(100, 100)

; 画面中央
myMainMenu.Show(A_ScreenWidth/2, A_ScreenHeight/2)
```

## EXEファイルへのコンパイル

### Ahk2Exeの使用

AutoHotkey v2に付属の`Ahk2Exe`を使用して、スクリプトを実行ファイルに変換できます。

1. Ahk2Exeを起動
2. **Source (script file)**: メインスクリプトを選択
3. **Destination (.exe file)**: 出力先を指定
4. **Base File**: AutoHotkey32.exe or AutoHotkey64.exe を選択
5. **Convert** をクリック

!!! warning "注意"
    コンパイル時に、`Lib/`フォルダと`images/`フォルダもEXEと同じ場所に配置する必要があります。

### 配布用パッケージ

配布する場合は、以下をフォルダにまとめます:

```
MyRadifyMenu_Portable/
├── MyMenu.exe
├── Radify.ahk
├── Lib/
│   └── Gdip_All.ahk
└── images/
    └── ...
```

## バージョン管理

### 設定ファイルのバックアップ

エディタは自動的にバックアップを作成しますが、手動でも保存することをお勧めします:

1. `menu_config.json` をコピー
2. 日付やバージョン番号を付けて保存
   - `menu_config_v1.0.json`
   - `menu_config_20260113.json`

### Gitでの管理

より高度なバージョン管理には、Gitを使用できます:

```bash
git init
git add menu_config.json templates.json images/
git commit -m "Initial menu configuration"
```

## 複数環境での使用

### 設定の同期

クラウドストレージ（Dropbox、OneDrive等）に設定ファイルを配置することで、複数のPCで同じメニューを使用できます。

1. `menu_config.json` をクラウドフォルダに配置
2. エディタで該当ファイルを開く
3. 編集・保存

### 環境別の設定

自宅PCと職場PCで異なるメニューを使う場合:

- 別々の設定ファイルを作成
- 環境に応じて読み込む設定を切り替え

## ベストプラクティス

### 定期的なエクスポート

メニューの大幅な変更前には、現在の状態をエクスポートしてバックアップを取りましょう。

### ドキュメント化

複雑なメニュー構造の場合、README.txtなどでメニューの構造や使い方を記述しておくと便利です。

### テスト環境

本番環境で使う前に、テスト用の設定で動作確認することをお勧めします。

## トラブルシューティング

### スクリプトが起動しない

1. AutoHotkey v2がインストールされているか確認
2. スクリプトファイルの拡張子が `.ahk` であることを確認
3. エラーメッセージを確認（右クリック→「Edit Script」で内容確認）

### アイコンが表示されない

1. `images/` フォルダが同じディレクトリにあるか確認
2. 画像ファイルが実際に存在するか確認
3. パスが相対パスで正しく記述されているか確認

### アクションが実行されない

1. スクリプト内のアクション定義を確認
2. 構文エラーがないかチェック
3. `MsgBox` を使ってデバッグ

### ホットキーが動作しない

1. 他のアプリとホットキーが競合していないか確認
2. 管理者権限で実行してみる
3. 別のホットキーに変更してみる

## 配布とライセンス

### 作成したメニューの配布

あなたが作成したメニュー設定は自由に配布できます（エディタのライセンスとは別）。

### Radifyライブラリのライセンス

Radifyライブラリのライセンスを確認してください。

### クレジット表記

配布する場合は、以下のような表記があると親切です:

```
Created with Radify Menu Editor
https://github.com/hinatahugu29/AHK_Radify_Editor
```

## 次のステップ

スクリプト出力の方法を理解したら、さらに高度な使い方に挑戦しましょう:

- [カスタムアクション](../advanced/custom-actions.md)
- [複数メニューの管理](../advanced/multiple-menus.md)
- [トラブルシューティング](../advanced/troubleshooting.md)
